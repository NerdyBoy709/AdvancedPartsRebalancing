@PART[mpdt-25]:AFTER[NearFuturePropulsion]
{
	MODULE
	{
		name = MultiModeEngine
		primaryEngineID = largestMPDT
		secondaryEngineID = largesthydrogenMPDT
		primaryEngineModeDisplayName = Lithium MPD
		secondaryEngineModeDisplayName = Hydrogen MPD
	}
	MODULE
	{
		name = ModuleEnginesFX
		engineID = largesthydrogenMPDT
		runningEffectName = run_ds02_core
		powerEffectName = run_ds02_plume
		thrustVectorTransformName = thrustTransform
		exhaustDamage = True
		ignitionThreshold = 0.1
		minThrust = 0
		maxThrust = 193.76
		heatProduction = 344.420042
		EngineType = Electric
		PROPELLANT
		{
			name = ElectricCharge
			ratio = 220.539593
			DrawGauge = True
			minResToLeave = 1.0
		}
		PROPELLANT
		{
			name = LqdHydrogen
			DrawGauge = True
			ratio = 2.7847784869101
		}
		atmosphereCurve
		{
			key = 0 5440
			key = 1 54
			key = 2 0.001
		}
	}
    EFFECTS
    {
        engage
        {
            AUDIO
            {
                channel = Ship
                clip = NearFuturePropulsion/Sounds/MPDTOn
                volume = 1.0
                pitch = 1.0
                loop = false
            }
        }
        flameout
        {
            PREFAB_PARTICLE
            {
                prefabName = fx_exhaustSparks_flameout_2
                transformName = thrustTransform
                oneShot = true
            }
            AUDIO
            {
                channel = Ship
                clip = NearFuturePropulsion/Sounds/GenericFlameout
                volume = 1.0
                pitch = 1.0
                loop = false
            }
        }
        run_ds02_core
        {
            AUDIO
            {
                channel = Ship
                clip = NearFuturePropulsion/Sounds/MPDTLoop01
                volume = 0.0 0.0
                volume = 0.01 0.1
                volume = 0.5 0.2
                volume = 1.0 0.4
                pitch = 0.0 1.4
                pitch = 0.5 1.2
                pitch = 1.0 1.0
                loop = true
            }  
        }	
    }
  MODULE
  {
    name = ModuleWaterfallFX
    moduleID = rocketFX-25
    CONTROLLER
    {
      name = atmosphereDepth
      linkedTo = atmosphere_density
    }
    CONTROLLER
    {
      name = throttle
      linkedTo = throttle
      engineID = largesthydrogenMPDT
      responseRateUp = 100
      responseRateDown = 100
    }
    CONTROLLER
    {
      name = random
      linkedTo = random
      noiseType = random
      range = -1,1
    }
    CONTROLLER
    {
      name = randomPerlin
      linkedTo = random
      noiseType = perlin
      scale = -0.100000001
      minimum = -0.200000003
      speed = 20
      seed = 1
    }
    EFFECT
    {
        name = engineLight
        parentName = thrustTransform
        MODEL
        {
          path = Waterfall/FX/fx-point-light
          positionOffset = 0,0,0
          rotationOffset = 0,0,0
          scaleOffset = 1,1,1
          LIGHT
          {
            transform = Light
            intensity = 1
            range = 11.5141268
            lightType = Point
            color = 0.886274517,0.643137276,0.643137276,1
            angle = 0
          }
        }
        LIGHTFLOATMODIFIER
        {
          name = lightIntensity
          controllerName = throttle
          transformName = Light
          combinationType = REPLACE
          useRandomness = True
          randomnessController = randomPerlin
          randomnessScale = 1
          floatName = Intensity
          floatCurve
          {
            key = 0 0 0 0
            key = 1 1 0 0
          }
        }
    }
    EFFECT
    {
      name = mpdtFXreaction
      parentName = thrustTransform
      MODEL
      {
        path = Waterfall/FX/fx-cylinder
        positionOffset = 0,0,-0.800000012
        rotationOffset = -90,0,0
        scaleOffset = 0.100000001,0.5,0.100000001
        MATERIAL
        {
          transform = Cylinder
          shader = Waterfall/Additive (Dynamic)
          randomizeSeed = True
          TEXTURE
          {
            textureSlotName = _MainTex
            texturePath = Waterfall/FX/fx-noise-1
            textureScale = 1,1
            textureOffset = 0,0
          }
          COLOR
          {
            colorName = _StartTint
            colorValue = 0.347234637,0.394015938,0.615686297,1
          }
          COLOR
          {
            colorName = _EndTint
            colorValue = 0.725490212,0.0745098069,0.664200187,1
          }
          FLOAT
          {
            floatName = _Fresnel
            value = 0.505554795
          }
          FLOAT
          {
            floatName = _Falloff
            value = 2.52777386
          }
          FLOAT
          {
            floatName = _FadeIn
            value = 0.444888204
          }
          FLOAT
          {
            floatName = _FadeOut
            value = 0.500499249
          }
          FLOAT
          {
            floatName = _ExpandLinear
            value = 6.47110128
          }
          FLOAT
          {
            floatName = _Noise
            value = 5.30832529
          }
          FLOAT
          {
            floatName = _SpeedY
            value = 0
          }
          FLOAT
          {
            floatName = _TileX
            value = 2
          }
          FLOAT
          {
            floatName = _ExpandSquare
            value = -3.84221625
          }
          FLOAT
          {
            floatName = _TintFalloff
            value = 0.859443069
          }
          FLOAT
          {
            floatName = _SpeedX
            value = 0
          }
        }
      }
      FLOATMODIFIER
      {
        name = tBright
        controllerName = throttle
        transformName = Cylinder
        combinationType = REPLACE
        useRandomness = False
        randomnessController = random
        randomnessScale = 1
        floatName = _Brightness
        floatCurve
        {
          key = 0 0 0 0
          key = 1 2 0 0
        }
      }
      FLOATMODIFIER
      {
        name = aBright
        controllerName = atmosphereDepth
        transformName = Cylinder
        combinationType = MULTIPLY
        useRandomness = False
        randomnessController = random
        randomnessScale = 1
        floatName = _Brightness
        floatCurve
        {
          key = 0 1 0 0
          key = 1 0.2 0 0
        }
      }
    }
    EFFECT
    {
      name = mpdtFXPlume
      parentName = thrustTransform
      MODEL
      {
        path = Waterfall/FX/fx-cylinder
        positionOffset = 0,0,-0.400000006
        rotationOffset = -90,0,0
        scaleOffset = 0.300000012,18,0.300000012
        MATERIAL
        {
          transform = Cylinder
          shader = Waterfall/Additive (Dynamic)
          randomizeSeed = True
          TEXTURE
          {
            textureSlotName = _MainTex
            texturePath = Waterfall/FX/fx-noise-1
            textureScale = 1,1
            textureOffset = 0,0
          }
          COLOR
          {
            colorName = _StartTint
            colorValue = 0.347234637,0.394015938,0.615686297,1
          }
          COLOR
          {
            colorName = _EndTint
            colorValue = 0.725490212,0.0745098069,0.664200187,1
          }
          FLOAT
          {
            floatName = _Fresnel
            value = 0.707776725
          }
          FLOAT
          {
            floatName = _Falloff
            value = 5.8644352
          }
          FLOAT
          {
            floatName = _FadeIn
            value = 0
          }
          FLOAT
          {
            floatName = _FadeOut
            value = 0
          }
          FLOAT
          {
            floatName = _ExpandLinear
            value = 10
          }
          FLOAT
          {
            floatName = _Noise
            value = 4.32249355
          }
          FLOAT
          {
            floatName = _SpeedY
            value = 22
          }
          FLOAT
          {
            floatName = _TileX
            value = 2
          }
          FLOAT
          {
            floatName = _ExpandSquare
            value = 0
          }
          FLOAT
          {
            floatName = _TintFalloff
            value = 0.4044438
          }
        }
      }
      FLOATMODIFIER
      {
        name = tBright
        controllerName = throttle
        transformName = Cylinder
        combinationType = REPLACE
        useRandomness = False
        randomnessController = random
        randomnessScale = 1
        floatName = _Brightness
        floatCurve
        {
          key = 0 0 0 0
          key = 1 0.3 0 0
        }
      }
      FLOATMODIFIER
      {
        name = aBright
        controllerName = atmosphereDepth
        transformName = Cylinder
        combinationType = MULTIPLY
        useRandomness = False
        randomnessController = random
        randomnessScale = 1
        floatName = _Brightness
        floatCurve
        {
          key = 0 1 0 0
          key = 1 0.2 0 0
        }
      }
    }
    EFFECT
    {
      name = mpdtFXcore
      parentName = thrustTransform
      MODEL
      {
        path = Waterfall/FX/fx-cylinder
        positionOffset = 0,0,-1.20000005
        rotationOffset = -90,0,0
        scaleOffset = 0.100000001,18,0.100000001
        MATERIAL
        {
          transform = Cylinder
          shader = Waterfall/Additive (Dynamic)
          randomizeSeed = True
          TEXTURE
          {
            textureSlotName = _MainTex
            texturePath = Waterfall/FX/fx-noise-1
            textureScale = 1,1
            textureOffset = 0,0
          }
          COLOR
          {
            colorName = _StartTint
            colorValue = 0.347234637,0.394015938,0.615686297,1
          }
          COLOR
          {
            colorName = _EndTint
            colorValue = 0.725490212,0.0745098069,0.664200187,1
          }
          FLOAT
          {
            floatName = _Fresnel
            value = 0.707776725
          }
          FLOAT
          {
            floatName = _Falloff
            value = 5.8644352
          }
          FLOAT
          {
            floatName = _FadeIn
            value = 0
          }
          FLOAT
          {
            floatName = _FadeOut
            value = 0
          }
          FLOAT
          {
            floatName = _ExpandLinear
            value = 10
          }
          FLOAT
          {
            floatName = _Noise
            value = 3.03332901
          }
          FLOAT
          {
            floatName = _SpeedY
            value = 28.2333012
          }
          FLOAT
          {
            floatName = _TileX
            value = 1
          }
          FLOAT
          {
            floatName = _ExpandSquare
            value = 0
          }
          FLOAT
          {
            floatName = _TintFalloff
            value = 2.52777386
          }
        }
      }
      FLOATMODIFIER
      {
        name = tBright
        controllerName = throttle
        transformName = Cylinder
        combinationType = REPLACE
        useRandomness = False
        randomnessController = random
        randomnessScale = 1
        floatName = _Brightness
        floatCurve
        {
          key = 0 0 0 0
          key = 1 0.5 0 0
        }
      }
      FLOATMODIFIER
      {
        name = aBright
        controllerName = atmosphereDepth
        transformName = Cylinder
        combinationType = MULTIPLY
        useRandomness = False
        randomnessController = random
        randomnessScale = 1
        floatName = _Brightness
        floatCurve
        {
          key = 0 1 0 0
          key = 1 0.2 0 0
        }
      }
    }
    EFFECT
    {
      name = mpdtFXFlare
      parentName = thrustTransform
      MODEL
      {
        path = Waterfall/FX/fx-billboard-generic-1
        positionOffset = 0,0,-1.5
        rotationOffset = 0,0,0
        scaleOffset = 1,0.5,1
        MATERIAL
        {
          transform = Billboard
          shader = Waterfall/Billboard (Additive Directional)
          randomizeSeed = True
          TEXTURE
          {
            textureSlotName = _MainTex
            texturePath = Waterfall/FX/fx_flarelamp-1
            textureScale = 1,1
            textureOffset = 0,0
          }
          COLOR
          {
            colorName = _StartTint
            colorValue = 0.347234637,0.394015938,0.615686297,1
          }
        }
      }
      FLOATMODIFIER
      {
        name = aBright
        controllerName = throttle
        transformName = Billboard
        combinationType = REPLACE
        useRandomness = False
        randomnessController = random
        randomnessScale = 0.200000003
        floatName = _Brightness
        floatCurve
        {
          key = 0 -1 0 0
          key = 0.8 0 0 0
          key = 1 1 0 0
        }
      }
      FLOATMODIFIER
      {
        name = aMult
        controllerName = atmosphereDepth
        transformName = Billboard
        combinationType = MULTIPLY
        useRandomness = True
        randomnessController = random
        randomnessScale = 0.200000003
        floatName = _Brightness
        floatCurve
        {
          key = 0 1 0 0
          key = 1 1 0 0
        }
      }
    }
  }	
}

@PART[mpdt-25]:AFTER[SystemHeatIonEngines]
{
    @MODULE[ModuleSystemHeatEngine]:HAS[#moduleID[engine]]
    {
        @moduleID = largestMPDT
        @systemHeatModuleID = largestMPDT
        @engineModuleID = largestMPDT	
    }
    MODULE
    {
        name = ModuleSystemHeatEngine
        moduleID = largesthydrogenMPDT
        systemHeatModuleID = largesthydrogenMPDT
        engineModuleID = largesthydrogenMPDT
        systemPower = 260
        systemOutletTemperature = 500

        temperatureCurve
        {
            key = 0 1.0
            key = 500 1.0
            key = 1000 0.0
        }
        shutdownTemperature = 800
    }  
}